
{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from orm_sqlalchemy.index import DatabaseHandler\n",
    "from utils.read_data import ReadFile\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "db = DatabaseHandler()\n",
    "db.create_tables(schema_name='trusted')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "This Connection is closed\n"
     ]
    }
   ],
   "source": [
    "query_result = db.execute_query('CREATE SCHEMA IF NOT EXISTS raw')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "query_result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "read_file = ReadFile()\n",
    "df = read_file.read_csv_to_dataframe(directory=\"data\", file_name=\"reviews.csv.gz\", compression='gzip')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Coluna listing_id - type: int64 - qtde de nan: 0\n",
      " Coluna id - type: int64 - qtde de nan: 0\n",
      " Coluna date - type: object - qtde de nan: 0\n",
      " Coluna reviewer_id - type: int64 - qtde de nan: 0\n",
      " Coluna reviewer_name - type: object - qtde de nan: 0\n",
      " Coluna comments - type: object - qtde de nan: 19\n"
     ]
    }
   ],
   "source": [
    "\n",
    "for col in df.columns:\n",
    "    print(f\" Coluna {col} - type: {df[col].dtypes} - qtde de nan: {df[col].isna().sum()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>listing_id</th>\n",
       "      <th>id</th>\n",
       "      <th>date</th>\n",
       "      <th>reviewer_id</th>\n",
       "      <th>reviewer_name</th>\n",
       "      <th>comments</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>231497</td>\n",
       "      <td>726625</td>\n",
       "      <td>2011-11-17</td>\n",
       "      <td>1356783</td>\n",
       "      <td>Jenny</td>\n",
       "      <td>Es un apartastudio muy bien ubicado. Tiene lo ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>17878</td>\n",
       "      <td>64852</td>\n",
       "      <td>2010-07-15</td>\n",
       "      <td>135370</td>\n",
       "      <td>Tia</td>\n",
       "      <td>This apartment is in a perfect location -- two...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>17878</td>\n",
       "      <td>76744</td>\n",
       "      <td>2010-08-11</td>\n",
       "      <td>10206</td>\n",
       "      <td>Mimi</td>\n",
       "      <td>we had a really great experience staying in Ma...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>17878</td>\n",
       "      <td>91074</td>\n",
       "      <td>2010-09-06</td>\n",
       "      <td>80253</td>\n",
       "      <td>Jan</td>\n",
       "      <td>Staying in Max appartment is like living in a ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17878</td>\n",
       "      <td>137528</td>\n",
       "      <td>2010-11-12</td>\n",
       "      <td>230449</td>\n",
       "      <td>Orene</td>\n",
       "      <td>In general very good and reasonable price.\\r&lt;b...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   listing_id      id        date  reviewer_id reviewer_name  \\\n",
       "0      231497  726625  2011-11-17      1356783         Jenny   \n",
       "1       17878   64852  2010-07-15       135370           Tia   \n",
       "2       17878   76744  2010-08-11        10206          Mimi   \n",
       "3       17878   91074  2010-09-06        80253           Jan   \n",
       "4       17878  137528  2010-11-12       230449         Orene   \n",
       "\n",
       "                                            comments  \n",
       "0  Es un apartastudio muy bien ubicado. Tiene lo ...  \n",
       "1  This apartment is in a perfect location -- two...  \n",
       "2  we had a really great experience staying in Ma...  \n",
       "3  Staying in Max appartment is like living in a ...  \n",
       "4  In general very good and reasonable price.\\r<b...  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = df.to_dict(orient=\"records\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "len(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "db.post_data(table=\"reviews\", data=data[0:100], schema=\"raw\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "db.create_tables(schema_name='raw')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "read_file = ReadFile()\n",
    "df_listining = read_file.read_csv_to_dataframe(directory=\"data\", file_name=\"listings.csv.gz\", compression='gzip')\n",
    "pd.set_option('display.max_columns', None)\n",
    "pd.set_option('display.max_rows', None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "host_is_superhost\n",
      "host_has_profile_pic\n",
      "host_identity_verified\n",
      "has_availability\n",
      "instant_bookable\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>listing_url</th>\n",
       "      <th>scrape_id</th>\n",
       "      <th>last_scraped</th>\n",
       "      <th>source</th>\n",
       "      <th>name</th>\n",
       "      <th>description</th>\n",
       "      <th>neighborhood_overview</th>\n",
       "      <th>picture_url</th>\n",
       "      <th>host_id</th>\n",
       "      <th>host_url</th>\n",
       "      <th>host_name</th>\n",
       "      <th>host_since</th>\n",
       "      <th>host_location</th>\n",
       "      <th>host_about</th>\n",
       "      <th>host_response_time</th>\n",
       "      <th>host_response_rate</th>\n",
       "      <th>host_acceptance_rate</th>\n",
       "      <th>host_is_superhost</th>\n",
       "      <th>host_thumbnail_url</th>\n",
       "      <th>host_picture_url</th>\n",
       "      <th>host_neighbourhood</th>\n",
       "      <th>host_listings_count</th>\n",
       "      <th>host_total_listings_count</th>\n",
       "      <th>host_verifications</th>\n",
       "      <th>host_has_profile_pic</th>\n",
       "      <th>host_identity_verified</th>\n",
       "      <th>neighbourhood</th>\n",
       "      <th>neighbourhood_cleansed</th>\n",
       "      <th>neighbourhood_group_cleansed</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>property_type</th>\n",
       "      <th>room_type</th>\n",
       "      <th>accommodates</th>\n",
       "      <th>bathrooms</th>\n",
       "      <th>bathrooms_text</th>\n",
       "      <th>bedrooms</th>\n",
       "      <th>beds</th>\n",
       "      <th>amenities</th>\n",
       "      <th>price</th>\n",
       "      <th>minimum_nights</th>\n",
       "      <th>maximum_nights</th>\n",
       "      <th>minimum_minimum_nights</th>\n",
       "      <th>maximum_minimum_nights</th>\n",
       "      <th>minimum_maximum_nights</th>\n",
       "      <th>maximum_maximum_nights</th>\n",
       "      <th>minimum_nights_avg_ntm</th>\n",
       "      <th>maximum_nights_avg_ntm</th>\n",
       "      <th>calendar_updated</th>\n",
       "      <th>has_availability</th>\n",
       "      <th>availability_30</th>\n",
       "      <th>availability_60</th>\n",
       "      <th>availability_90</th>\n",
       "      <th>availability_365</th>\n",
       "      <th>calendar_last_scraped</th>\n",
       "      <th>number_of_reviews</th>\n",
       "      <th>number_of_reviews_ltm</th>\n",
       "      <th>number_of_reviews_l30d</th>\n",
       "      <th>first_review</th>\n",
       "      <th>last_review</th>\n",
       "      <th>review_scores_rating</th>\n",
       "      <th>review_scores_accuracy</th>\n",
       "      <th>review_scores_cleanliness</th>\n",
       "      <th>review_scores_checkin</th>\n",
       "      <th>review_scores_communication</th>\n",
       "      <th>review_scores_location</th>\n",
       "      <th>review_scores_value</th>\n",
       "      <th>license</th>\n",
       "      <th>instant_bookable</th>\n",
       "      <th>calculated_host_listings_count</th>\n",
       "      <th>calculated_host_listings_count_entire_homes</th>\n",
       "      <th>calculated_host_listings_count_private_rooms</th>\n",
       "      <th>calculated_host_listings_count_shared_rooms</th>\n",
       "      <th>reviews_per_month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>231497</td>\n",
       "      <td>https://www.airbnb.com/rooms/231497</td>\n",
       "      <td>20230922043705</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>city scrape</td>\n",
       "      <td>Rental unit in Rio de Janeiro · ★4.73 · 1 bedr...</td>\n",
       "      <td>This is a big studio at the end of Copacabana,...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://a0.muscache.com/pictures/3582382/ee8ac...</td>\n",
       "      <td>1207700</td>\n",
       "      <td>https://www.airbnb.com/users/show/1207700</td>\n",
       "      <td>Maria Luiza</td>\n",
       "      <td>2011-09-25</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Meu nome é Maria Luiza, adoro ajudar meus hósp...</td>\n",
       "      <td>within a few hours</td>\n",
       "      <td>100%</td>\n",
       "      <td>82%</td>\n",
       "      <td>False</td>\n",
       "      <td>https://a0.muscache.com/im/users/1207700/profi...</td>\n",
       "      <td>https://a0.muscache.com/im/users/1207700/profi...</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>4.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>['email', 'phone']</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-22.98238</td>\n",
       "      <td>-43.19215</td>\n",
       "      <td>Entire rental unit</td>\n",
       "      <td>Entire home/apt</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1 bath</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[\"Hangers\", \"Body soap\", \"Elevator\", \"Bed line...</td>\n",
       "      <td>$180.00</td>\n",
       "      <td>3</td>\n",
       "      <td>89</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>89</td>\n",
       "      <td>89</td>\n",
       "      <td>3.0</td>\n",
       "      <td>89.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>204</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>78</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>2011-11-17</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>4.73</td>\n",
       "      <td>4.83</td>\n",
       "      <td>4.86</td>\n",
       "      <td>4.89</td>\n",
       "      <td>4.92</td>\n",
       "      <td>4.90</td>\n",
       "      <td>4.65</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>231516</td>\n",
       "      <td>https://www.airbnb.com/rooms/231516</td>\n",
       "      <td>20230922043705</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>city scrape</td>\n",
       "      <td>Rental unit in Rio de Janeiro · ★4.71 · 1 bedr...</td>\n",
       "      <td>Special location of the building, on Copacaban...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://a0.muscache.com/pictures/3671683/d74b4...</td>\n",
       "      <td>1207700</td>\n",
       "      <td>https://www.airbnb.com/users/show/1207700</td>\n",
       "      <td>Maria Luiza</td>\n",
       "      <td>2011-09-25</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Meu nome é Maria Luiza, adoro ajudar meus hósp...</td>\n",
       "      <td>within a few hours</td>\n",
       "      <td>100%</td>\n",
       "      <td>82%</td>\n",
       "      <td>False</td>\n",
       "      <td>https://a0.muscache.com/im/users/1207700/profi...</td>\n",
       "      <td>https://a0.muscache.com/im/users/1207700/profi...</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>4.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>['email', 'phone']</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-22.97787</td>\n",
       "      <td>-43.18792</td>\n",
       "      <td>Entire rental unit</td>\n",
       "      <td>Entire home/apt</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[\"TV\", \"Kitchen\", \"Wifi\", \"Elevator\", \"Air con...</td>\n",
       "      <td>$350.00</td>\n",
       "      <td>3</td>\n",
       "      <td>89</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>89</td>\n",
       "      <td>89</td>\n",
       "      <td>3.0</td>\n",
       "      <td>89.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>True</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>113</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>2016-08-21</td>\n",
       "      <td>4.71</td>\n",
       "      <td>4.76</td>\n",
       "      <td>4.52</td>\n",
       "      <td>4.79</td>\n",
       "      <td>4.86</td>\n",
       "      <td>4.93</td>\n",
       "      <td>4.38</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>236991</td>\n",
       "      <td>https://www.airbnb.com/rooms/236991</td>\n",
       "      <td>20230922043705</td>\n",
       "      <td>2023-09-23</td>\n",
       "      <td>city scrape</td>\n",
       "      <td>Rental unit in Rio de Janeiro · ★4.89 · 1 bedr...</td>\n",
       "      <td>Aconchegante, amplo, básico, arejado, iluminad...</td>\n",
       "      <td>Copacabana, apelidada a princesinha do mar, fa...</td>\n",
       "      <td>https://a0.muscache.com/pictures/5725a59b-147d...</td>\n",
       "      <td>1241662</td>\n",
       "      <td>https://www.airbnb.com/users/show/1241662</td>\n",
       "      <td>Nilda</td>\n",
       "      <td>2011-10-03</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Hellow ! Im Nilda!  I love Rio de Janeiro.    ...</td>\n",
       "      <td>within an hour</td>\n",
       "      <td>100%</td>\n",
       "      <td>96%</td>\n",
       "      <td>True</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/fea78...</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/fea78...</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>['email', 'phone']</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-22.96488</td>\n",
       "      <td>-43.17478</td>\n",
       "      <td>Entire rental unit</td>\n",
       "      <td>Entire home/apt</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1 bath</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>[\"Clothing storage: wardrobe\", \"Public or shar...</td>\n",
       "      <td>$190.00</td>\n",
       "      <td>5</td>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>1125</td>\n",
       "      <td>1125</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1125.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>True</td>\n",
       "      <td>14</td>\n",
       "      <td>21</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>2023-09-23</td>\n",
       "      <td>76</td>\n",
       "      <td>24</td>\n",
       "      <td>2</td>\n",
       "      <td>2014-03-03</td>\n",
       "      <td>2023-09-05</td>\n",
       "      <td>4.89</td>\n",
       "      <td>4.96</td>\n",
       "      <td>4.91</td>\n",
       "      <td>4.97</td>\n",
       "      <td>4.96</td>\n",
       "      <td>4.99</td>\n",
       "      <td>4.89</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>17878</td>\n",
       "      <td>https://www.airbnb.com/rooms/17878</td>\n",
       "      <td>20230922043705</td>\n",
       "      <td>2023-09-23</td>\n",
       "      <td>city scrape</td>\n",
       "      <td>Condo in Rio de Janeiro · ★4.70 · 2 bedrooms ·...</td>\n",
       "      <td>Please note that elevated rates applies for Ne...</td>\n",
       "      <td>This is the one of the bests spots in Rio. Bec...</td>\n",
       "      <td>https://a0.muscache.com/pictures/65320518/3069...</td>\n",
       "      <td>68997</td>\n",
       "      <td>https://www.airbnb.com/users/show/68997</td>\n",
       "      <td>Matthias</td>\n",
       "      <td>2010-01-08</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>I  am a  journalist/writer. Lived  in NYC for ...</td>\n",
       "      <td>within an hour</td>\n",
       "      <td>100%</td>\n",
       "      <td>96%</td>\n",
       "      <td>True</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/67b13...</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/67b13...</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>2.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>['email', 'phone']</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-22.96599</td>\n",
       "      <td>-43.17940</td>\n",
       "      <td>Entire condo</td>\n",
       "      <td>Entire home/apt</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1 bath</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>[\"Patio or balcony\", \"Hangers\", \"Paid parking ...</td>\n",
       "      <td>$279.00</td>\n",
       "      <td>5</td>\n",
       "      <td>28</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>28</td>\n",
       "      <td>28</td>\n",
       "      <td>5.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>True</td>\n",
       "      <td>14</td>\n",
       "      <td>21</td>\n",
       "      <td>38</td>\n",
       "      <td>265</td>\n",
       "      <td>2023-09-23</td>\n",
       "      <td>301</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>2010-07-15</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>4.70</td>\n",
       "      <td>4.77</td>\n",
       "      <td>4.64</td>\n",
       "      <td>4.83</td>\n",
       "      <td>4.91</td>\n",
       "      <td>4.77</td>\n",
       "      <td>4.67</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25026</td>\n",
       "      <td>https://www.airbnb.com/rooms/25026</td>\n",
       "      <td>20230922043705</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>city scrape</td>\n",
       "      <td>Rental unit in Rio de Janeiro · ★4.71 · 1 bedr...</td>\n",
       "      <td>**Fully renovated  in Dec 2022, new kitchen, n...</td>\n",
       "      <td>Copacabana is a lively neighborhood and the ap...</td>\n",
       "      <td>https://a0.muscache.com/pictures/a745aa21-b8dd...</td>\n",
       "      <td>102840</td>\n",
       "      <td>https://www.airbnb.com/users/show/102840</td>\n",
       "      <td>Viviane</td>\n",
       "      <td>2010-04-03</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Hi guys,\\n\\nViviane is a commercial photograph...</td>\n",
       "      <td>within a few hours</td>\n",
       "      <td>100%</td>\n",
       "      <td>73%</td>\n",
       "      <td>True</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/315dd...</td>\n",
       "      <td>https://a0.muscache.com/im/pictures/user/315dd...</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>['email', 'phone']</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>Rio de Janeiro, Brazil</td>\n",
       "      <td>Copacabana</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-22.97735</td>\n",
       "      <td>-43.19105</td>\n",
       "      <td>Entire rental unit</td>\n",
       "      <td>Entire home/apt</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1 bath</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>[\"Clothing storage: wardrobe\", \"Dedicated work...</td>\n",
       "      <td>$330.00</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>60</td>\n",
       "      <td>2.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>True</td>\n",
       "      <td>6</td>\n",
       "      <td>11</td>\n",
       "      <td>41</td>\n",
       "      <td>203</td>\n",
       "      <td>2023-09-22</td>\n",
       "      <td>272</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>2010-06-07</td>\n",
       "      <td>2023-09-07</td>\n",
       "      <td>4.71</td>\n",
       "      <td>4.69</td>\n",
       "      <td>4.78</td>\n",
       "      <td>4.81</td>\n",
       "      <td>4.92</td>\n",
       "      <td>4.84</td>\n",
       "      <td>4.59</td>\n",
       "      <td>NaN</td>\n",
       "      <td>False</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.68</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id                          listing_url       scrape_id last_scraped  \\\n",
       "0  231497  https://www.airbnb.com/rooms/231497  20230922043705   2023-09-22   \n",
       "1  231516  https://www.airbnb.com/rooms/231516  20230922043705   2023-09-22   \n",
       "2  236991  https://www.airbnb.com/rooms/236991  20230922043705   2023-09-23   \n",
       "3   17878   https://www.airbnb.com/rooms/17878  20230922043705   2023-09-23   \n",
       "4   25026   https://www.airbnb.com/rooms/25026  20230922043705   2023-09-22   \n",
       "\n",
       "        source                                               name  \\\n",
       "0  city scrape  Rental unit in Rio de Janeiro · ★4.73 · 1 bedr...   \n",
       "1  city scrape  Rental unit in Rio de Janeiro · ★4.71 · 1 bedr...   \n",
       "2  city scrape  Rental unit in Rio de Janeiro · ★4.89 · 1 bedr...   \n",
       "3  city scrape  Condo in Rio de Janeiro · ★4.70 · 2 bedrooms ·...   \n",
       "4  city scrape  Rental unit in Rio de Janeiro · ★4.71 · 1 bedr...   \n",
       "\n",
       "                                         description  \\\n",
       "0  This is a big studio at the end of Copacabana,...   \n",
       "1  Special location of the building, on Copacaban...   \n",
       "2  Aconchegante, amplo, básico, arejado, iluminad...   \n",
       "3  Please note that elevated rates applies for Ne...   \n",
       "4  **Fully renovated  in Dec 2022, new kitchen, n...   \n",
       "\n",
       "                               neighborhood_overview  \\\n",
       "0                                                NaN   \n",
       "1                                                NaN   \n",
       "2  Copacabana, apelidada a princesinha do mar, fa...   \n",
       "3  This is the one of the bests spots in Rio. Bec...   \n",
       "4  Copacabana is a lively neighborhood and the ap...   \n",
       "\n",
       "                                         picture_url  host_id  \\\n",
       "0  https://a0.muscache.com/pictures/3582382/ee8ac...  1207700   \n",
       "1  https://a0.muscache.com/pictures/3671683/d74b4...  1207700   \n",
       "2  https://a0.muscache.com/pictures/5725a59b-147d...  1241662   \n",
       "3  https://a0.muscache.com/pictures/65320518/3069...    68997   \n",
       "4  https://a0.muscache.com/pictures/a745aa21-b8dd...   102840   \n",
       "\n",
       "                                    host_url    host_name  host_since  \\\n",
       "0  https://www.airbnb.com/users/show/1207700  Maria Luiza  2011-09-25   \n",
       "1  https://www.airbnb.com/users/show/1207700  Maria Luiza  2011-09-25   \n",
       "2  https://www.airbnb.com/users/show/1241662        Nilda  2011-10-03   \n",
       "3    https://www.airbnb.com/users/show/68997     Matthias  2010-01-08   \n",
       "4   https://www.airbnb.com/users/show/102840      Viviane  2010-04-03   \n",
       "\n",
       "            host_location                                         host_about  \\\n",
       "0  Rio de Janeiro, Brazil  Meu nome é Maria Luiza, adoro ajudar meus hósp...   \n",
       "1  Rio de Janeiro, Brazil  Meu nome é Maria Luiza, adoro ajudar meus hósp...   \n",
       "2  Rio de Janeiro, Brazil  Hellow ! Im Nilda!  I love Rio de Janeiro.    ...   \n",
       "3  Rio de Janeiro, Brazil  I  am a  journalist/writer. Lived  in NYC for ...   \n",
       "4  Rio de Janeiro, Brazil  Hi guys,\\n\\nViviane is a commercial photograph...   \n",
       "\n",
       "   host_response_time host_response_rate host_acceptance_rate  \\\n",
       "0  within a few hours               100%                  82%   \n",
       "1  within a few hours               100%                  82%   \n",
       "2      within an hour               100%                  96%   \n",
       "3      within an hour               100%                  96%   \n",
       "4  within a few hours               100%                  73%   \n",
       "\n",
       "   host_is_superhost                                 host_thumbnail_url  \\\n",
       "0              False  https://a0.muscache.com/im/users/1207700/profi...   \n",
       "1              False  https://a0.muscache.com/im/users/1207700/profi...   \n",
       "2               True  https://a0.muscache.com/im/pictures/user/fea78...   \n",
       "3               True  https://a0.muscache.com/im/pictures/user/67b13...   \n",
       "4               True  https://a0.muscache.com/im/pictures/user/315dd...   \n",
       "\n",
       "                                    host_picture_url host_neighbourhood  \\\n",
       "0  https://a0.muscache.com/im/users/1207700/profi...         Copacabana   \n",
       "1  https://a0.muscache.com/im/users/1207700/profi...         Copacabana   \n",
       "2  https://a0.muscache.com/im/pictures/user/fea78...         Copacabana   \n",
       "3  https://a0.muscache.com/im/pictures/user/67b13...         Copacabana   \n",
       "4  https://a0.muscache.com/im/pictures/user/315dd...         Copacabana   \n",
       "\n",
       "   host_listings_count  host_total_listings_count  host_verifications  \\\n",
       "0                  4.0                        8.0  ['email', 'phone']   \n",
       "1                  4.0                        8.0  ['email', 'phone']   \n",
       "2                  2.0                        2.0  ['email', 'phone']   \n",
       "3                  2.0                        5.0  ['email', 'phone']   \n",
       "4                  1.0                        5.0  ['email', 'phone']   \n",
       "\n",
       "   host_has_profile_pic  host_identity_verified           neighbourhood  \\\n",
       "0                  True                    True                     NaN   \n",
       "1                  True                    True                     NaN   \n",
       "2                  True                    True  Rio de Janeiro, Brazil   \n",
       "3                  True                    True  Rio de Janeiro, Brazil   \n",
       "4                  True                    True  Rio de Janeiro, Brazil   \n",
       "\n",
       "  neighbourhood_cleansed  neighbourhood_group_cleansed  latitude  longitude  \\\n",
       "0             Copacabana                           NaN -22.98238  -43.19215   \n",
       "1             Copacabana                           NaN -22.97787  -43.18792   \n",
       "2             Copacabana                           NaN -22.96488  -43.17478   \n",
       "3             Copacabana                           NaN -22.96599  -43.17940   \n",
       "4             Copacabana                           NaN -22.97735  -43.19105   \n",
       "\n",
       "        property_type        room_type  accommodates  bathrooms  \\\n",
       "0  Entire rental unit  Entire home/apt             4        NaN   \n",
       "1  Entire rental unit  Entire home/apt             4        NaN   \n",
       "2  Entire rental unit  Entire home/apt             5        NaN   \n",
       "3        Entire condo  Entire home/apt             5        NaN   \n",
       "4  Entire rental unit  Entire home/apt             3        NaN   \n",
       "\n",
       "  bathrooms_text  bedrooms  beds  \\\n",
       "0         1 bath       1.0   1.0   \n",
       "1            NaN       1.0   1.0   \n",
       "2         1 bath       1.0   4.0   \n",
       "3         1 bath       2.0   2.0   \n",
       "4         1 bath       1.0   1.0   \n",
       "\n",
       "                                           amenities    price  minimum_nights  \\\n",
       "0  [\"Hangers\", \"Body soap\", \"Elevator\", \"Bed line...  $180.00               3   \n",
       "1  [\"TV\", \"Kitchen\", \"Wifi\", \"Elevator\", \"Air con...  $350.00               3   \n",
       "2  [\"Clothing storage: wardrobe\", \"Public or shar...  $190.00               5   \n",
       "3  [\"Patio or balcony\", \"Hangers\", \"Paid parking ...  $279.00               5   \n",
       "4  [\"Clothing storage: wardrobe\", \"Dedicated work...  $330.00               2   \n",
       "\n",
       "   maximum_nights  minimum_minimum_nights  maximum_minimum_nights  \\\n",
       "0              89                       3                       3   \n",
       "1              89                       3                       3   \n",
       "2              14                       4                       7   \n",
       "3              28                       5                       5   \n",
       "4              60                       2                       2   \n",
       "\n",
       "   minimum_maximum_nights  maximum_maximum_nights  minimum_nights_avg_ntm  \\\n",
       "0                      89                      89                     3.0   \n",
       "1                      89                      89                     3.0   \n",
       "2                    1125                    1125                     5.0   \n",
       "3                      28                      28                     5.0   \n",
       "4                      60                      60                     2.0   \n",
       "\n",
       "   maximum_nights_avg_ntm  calendar_updated  has_availability  \\\n",
       "0                    89.0               NaN              True   \n",
       "1                    89.0               NaN              True   \n",
       "2                  1125.0               NaN              True   \n",
       "3                    28.0               NaN              True   \n",
       "4                    60.0               NaN              True   \n",
       "\n",
       "   availability_30  availability_60  availability_90  availability_365  \\\n",
       "0                0                0                0               204   \n",
       "1                0                0                1               113   \n",
       "2               14               21               51                51   \n",
       "3               14               21               38               265   \n",
       "4                6               11               41               203   \n",
       "\n",
       "  calendar_last_scraped  number_of_reviews  number_of_reviews_ltm  \\\n",
       "0            2023-09-22                 78                      9   \n",
       "1            2023-09-22                 29                      0   \n",
       "2            2023-09-23                 76                     24   \n",
       "3            2023-09-23                301                     25   \n",
       "4            2023-09-22                272                     24   \n",
       "\n",
       "   number_of_reviews_l30d first_review last_review  review_scores_rating  \\\n",
       "0                       1   2011-11-17  2023-09-11                  4.73   \n",
       "1                       0   2011-11-02  2016-08-21                  4.71   \n",
       "2                       2   2014-03-03  2023-09-05                  4.89   \n",
       "3                       1   2010-07-15  2023-09-11                  4.70   \n",
       "4                       1   2010-06-07  2023-09-07                  4.71   \n",
       "\n",
       "   review_scores_accuracy  review_scores_cleanliness  review_scores_checkin  \\\n",
       "0                    4.83                       4.86                   4.89   \n",
       "1                    4.76                       4.52                   4.79   \n",
       "2                    4.96                       4.91                   4.97   \n",
       "3                    4.77                       4.64                   4.83   \n",
       "4                    4.69                       4.78                   4.81   \n",
       "\n",
       "   review_scores_communication  review_scores_location  review_scores_value  \\\n",
       "0                         4.92                    4.90                 4.65   \n",
       "1                         4.86                    4.93                 4.38   \n",
       "2                         4.96                    4.99                 4.89   \n",
       "3                         4.91                    4.77                 4.67   \n",
       "4                         4.92                    4.84                 4.59   \n",
       "\n",
       "   license  instant_bookable  calculated_host_listings_count  \\\n",
       "0      NaN             False                               4   \n",
       "1      NaN             False                               4   \n",
       "2      NaN             False                               2   \n",
       "3      NaN             False                               1   \n",
       "4      NaN             False                               1   \n",
       "\n",
       "   calculated_host_listings_count_entire_homes  \\\n",
       "0                                            4   \n",
       "1                                            4   \n",
       "2                                            2   \n",
       "3                                            1   \n",
       "4                                            1   \n",
       "\n",
       "   calculated_host_listings_count_private_rooms  \\\n",
       "0                                             0   \n",
       "1                                             0   \n",
       "2                                             0   \n",
       "3                                             0   \n",
       "4                                             0   \n",
       "\n",
       "   calculated_host_listings_count_shared_rooms  reviews_per_month  \n",
       "0                                            0               0.54  \n",
       "1                                            0               0.20  \n",
       "2                                            0               0.65  \n",
       "3                                            0               1.87  \n",
       "4                                            0               1.68  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "boolean_column = [\"host_is_superhost\", \"host_has_profile_pic\",\t\"host_identity_verified\", \"has_availability\", \"instant_bookable\"]\n",
    "for column in boolean_column:\n",
    "    print(column)\n",
    "    df_listining[column].replace({\"t\": True, \"f\": False, np.nan: False}, inplace=True)\n",
    "\n",
    "df_listining.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 31964 entries, 0 to 31963\n",
      "Data columns (total 75 columns):\n",
      " #   Column                                        Non-Null Count  Dtype  \n",
      "---  ------                                        --------------  -----  \n",
      " 0   id                                            31964 non-null  int64  \n",
      " 1   listing_url                                   31964 non-null  object \n",
      " 2   scrape_id                                     31964 non-null  int64  \n",
      " 3   last_scraped                                  31964 non-null  object \n",
      " 4   source                                        31964 non-null  object \n",
      " 5   name                                          31964 non-null  object \n",
      " 6   description                                   31964 non-null  object \n",
      " 7   neighborhood_overview                         31964 non-null  object \n",
      " 8   picture_url                                   31964 non-null  object \n",
      " 9   host_id                                       31964 non-null  int64  \n",
      " 10  host_url                                      31964 non-null  object \n",
      " 11  host_name                                     31964 non-null  object \n",
      " 12  host_since                                    31964 non-null  object \n",
      " 13  host_location                                 31964 non-null  object \n",
      " 14  host_about                                    31964 non-null  object \n",
      " 15  host_response_time                            31964 non-null  object \n",
      " 16  host_response_rate                            31964 non-null  object \n",
      " 17  host_acceptance_rate                          31964 non-null  object \n",
      " 18  host_is_superhost                             31964 non-null  bool   \n",
      " 19  host_thumbnail_url                            31964 non-null  object \n",
      " 20  host_picture_url                              31964 non-null  object \n",
      " 21  host_neighbourhood                            31964 non-null  object \n",
      " 22  host_listings_count                           31964 non-null  float64\n",
      " 23  host_total_listings_count                     31964 non-null  float64\n",
      " 24  host_verifications                            31964 non-null  object \n",
      " 25  host_has_profile_pic                          31964 non-null  bool   \n",
      " 26  host_identity_verified                        31964 non-null  bool   \n",
      " 27  neighbourhood                                 31964 non-null  object \n",
      " 28  neighbourhood_cleansed                        31964 non-null  object \n",
      " 29  neighbourhood_group_cleansed                  31964 non-null  float64\n",
      " 30  latitude                                      31964 non-null  float64\n",
      " 31  longitude                                     31964 non-null  float64\n",
      " 32  property_type                                 31964 non-null  object \n",
      " 33  room_type                                     31964 non-null  object \n",
      " 34  accommodates                                  31964 non-null  int64  \n",
      " 35  bathrooms                                     31964 non-null  float64\n",
      " 36  bathrooms_text                                31964 non-null  object \n",
      " 37  bedrooms                                      31964 non-null  float64\n",
      " 38  beds                                          31964 non-null  float64\n",
      " 39  amenities                                     31964 non-null  object \n",
      " 40  price                                         31964 non-null  object \n",
      " 41  minimum_nights                                31964 non-null  int64  \n",
      " 42  maximum_nights                                31964 non-null  int64  \n",
      " 43  minimum_minimum_nights                        31964 non-null  int64  \n",
      " 44  maximum_minimum_nights                        31964 non-null  int64  \n",
      " 45  minimum_maximum_nights                        31964 non-null  int64  \n",
      " 46  maximum_maximum_nights                        31964 non-null  int64  \n",
      " 47  minimum_nights_avg_ntm                        31964 non-null  float64\n",
      " 48  maximum_nights_avg_ntm                        31964 non-null  float64\n",
      " 49  calendar_updated                              31964 non-null  float64\n",
      " 50  has_availability                              31964 non-null  bool   \n",
      " 51  availability_30                               31964 non-null  int64  \n",
      " 52  availability_60                               31964 non-null  int64  \n",
      " 53  availability_90                               31964 non-null  int64  \n",
      " 54  availability_365                              31964 non-null  int64  \n",
      " 55  calendar_last_scraped                         31964 non-null  object \n",
      " 56  number_of_reviews                             31964 non-null  int64  \n",
      " 57  number_of_reviews_ltm                         31964 non-null  int64  \n",
      " 58  number_of_reviews_l30d                        31964 non-null  int64  \n",
      " 59  first_review                                  31964 non-null  object \n",
      " 60  last_review                                   31964 non-null  object \n",
      " 61  review_scores_rating                          31964 non-null  float64\n",
      " 62  review_scores_accuracy                        31964 non-null  float64\n",
      " 63  review_scores_cleanliness                     31964 non-null  float64\n",
      " 64  review_scores_checkin                         31964 non-null  float64\n",
      " 65  review_scores_communication                   31964 non-null  float64\n",
      " 66  review_scores_location                        31964 non-null  float64\n",
      " 67  review_scores_value                           31964 non-null  float64\n",
      " 68  license                                       31964 non-null  float64\n",
      " 69  instant_bookable                              31964 non-null  bool   \n",
      " 70  calculated_host_listings_count                31964 non-null  int64  \n",
      " 71  calculated_host_listings_count_entire_homes   31964 non-null  int64  \n",
      " 72  calculated_host_listings_count_private_rooms  31964 non-null  int64  \n",
      " 73  calculated_host_listings_count_shared_rooms   31964 non-null  int64  \n",
      " 74  reviews_per_month                             31964 non-null  float64\n",
      "dtypes: bool(5), float64(20), int64(21), object(29)\n",
      "memory usage: 17.2+ MB\n"
     ]
    }
   ],
   "source": [
    "for col in df_listining.columns:\n",
    "    if df_listining[col].dtypes == 'int64' or df_listining[col].dtypes == 'float64':\n",
    "        df_listining[col].replace(np.nan, 0, inplace=True)\n",
    "    else:\n",
    "        df_listining[col].replace(np.nan, \"\", inplace=True)\n",
    "        \n",
    "\n",
    "df_listining.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Coluna id - type: int64 - qtde de nan: 0\n",
      " Coluna listing_url - type: object - qtde de nan: 0\n",
      " Coluna scrape_id - type: int64 - qtde de nan: 0\n",
      " Coluna last_scraped - type: object - qtde de nan: 0\n",
      " Coluna source - type: object - qtde de nan: 0\n",
      " Coluna name - type: object - qtde de nan: 0\n",
      " Coluna description - type: object - qtde de nan: 0\n",
      " Coluna neighborhood_overview - type: object - qtde de nan: 0\n",
      " Coluna picture_url - type: object - qtde de nan: 0\n",
      " Coluna host_id - type: int64 - qtde de nan: 0\n",
      " Coluna host_url - type: object - qtde de nan: 0\n",
      " Coluna host_name - type: object - qtde de nan: 0\n",
      " Coluna host_since - type: object - qtde de nan: 0\n",
      " Coluna host_location - type: object - qtde de nan: 0\n",
      " Coluna host_about - type: object - qtde de nan: 0\n",
      " Coluna host_response_time - type: object - qtde de nan: 0\n",
      " Coluna host_response_rate - type: object - qtde de nan: 0\n",
      " Coluna host_acceptance_rate - type: object - qtde de nan: 0\n",
      " Coluna host_is_superhost - type: bool - qtde de nan: 0\n",
      " Coluna host_thumbnail_url - type: object - qtde de nan: 0\n",
      " Coluna host_picture_url - type: object - qtde de nan: 0\n",
      " Coluna host_neighbourhood - type: object - qtde de nan: 0\n",
      " Coluna host_listings_count - type: float64 - qtde de nan: 0\n",
      " Coluna host_total_listings_count - type: float64 - qtde de nan: 0\n",
      " Coluna host_verifications - type: object - qtde de nan: 0\n",
      " Coluna host_has_profile_pic - type: bool - qtde de nan: 0\n",
      " Coluna host_identity_verified - type: bool - qtde de nan: 0\n",
      " Coluna neighbourhood - type: object - qtde de nan: 0\n",
      " Coluna neighbourhood_cleansed - type: object - qtde de nan: 0\n",
      " Coluna neighbourhood_group_cleansed - type: float64 - qtde de nan: 0\n",
      " Coluna latitude - type: float64 - qtde de nan: 0\n",
      " Coluna longitude - type: float64 - qtde de nan: 0\n",
      " Coluna property_type - type: object - qtde de nan: 0\n",
      " Coluna room_type - type: object - qtde de nan: 0\n",
      " Coluna accommodates - type: int64 - qtde de nan: 0\n",
      " Coluna bathrooms - type: float64 - qtde de nan: 0\n",
      " Coluna bathrooms_text - type: object - qtde de nan: 0\n",
      " Coluna bedrooms - type: float64 - qtde de nan: 0\n",
      " Coluna beds - type: float64 - qtde de nan: 0\n",
      " Coluna amenities - type: object - qtde de nan: 0\n",
      " Coluna price - type: object - qtde de nan: 0\n",
      " Coluna minimum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna maximum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna minimum_minimum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna maximum_minimum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna minimum_maximum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna maximum_maximum_nights - type: int64 - qtde de nan: 0\n",
      " Coluna minimum_nights_avg_ntm - type: float64 - qtde de nan: 0\n",
      " Coluna maximum_nights_avg_ntm - type: float64 - qtde de nan: 0\n",
      " Coluna calendar_updated - type: float64 - qtde de nan: 0\n",
      " Coluna has_availability - type: bool - qtde de nan: 0\n",
      " Coluna availability_30 - type: int64 - qtde de nan: 0\n",
      " Coluna availability_60 - type: int64 - qtde de nan: 0\n",
      " Coluna availability_90 - type: int64 - qtde de nan: 0\n",
      " Coluna availability_365 - type: int64 - qtde de nan: 0\n",
      " Coluna calendar_last_scraped - type: object - qtde de nan: 0\n",
      " Coluna number_of_reviews - type: int64 - qtde de nan: 0\n",
      " Coluna number_of_reviews_ltm - type: int64 - qtde de nan: 0\n",
      " Coluna number_of_reviews_l30d - type: int64 - qtde de nan: 0\n",
      " Coluna first_review - type: object - qtde de nan: 0\n",
      " Coluna last_review - type: object - qtde de nan: 0\n",
      " Coluna review_scores_rating - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_accuracy - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_cleanliness - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_checkin - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_communication - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_location - type: float64 - qtde de nan: 0\n",
      " Coluna review_scores_value - type: float64 - qtde de nan: 0\n",
      " Coluna license - type: float64 - qtde de nan: 0\n",
      " Coluna instant_bookable - type: bool - qtde de nan: 0\n",
      " Coluna calculated_host_listings_count - type: int64 - qtde de nan: 0\n",
      " Coluna calculated_host_listings_count_entire_homes - type: int64 - qtde de nan: 0\n",
      " Coluna calculated_host_listings_count_private_rooms - type: int64 - qtde de nan: 0\n",
      " Coluna calculated_host_listings_count_shared_rooms - type: int64 - qtde de nan: 0\n",
      " Coluna reviews_per_month - type: float64 - qtde de nan: 0\n"
     ]
    }
   ],
   "source": [
    "for col in df_listining.columns:\n",
    "    print(f\" Coluna {col} - type: {df_listining[col].dtypes} - qtde de nan: {df_listining[col].isna().sum()}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_listining = df_listining.to_dict(orient=\"records\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(231497) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 231497, 'listing_url': 'https://www.airbnb.com/rooms/231497', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.73 · 1 bedroom · 1 bed · 1 bath', 'description': 'This is a big studio at the end of Copacabana, walking distance to Arpoador and Ipanema, which can accomodate 4 persons, 2 in a double bed and anothe ... (702 characters truncated) ... two blocks away from the flat) and taxis. <br /> <br />You are very close to the \"Fortress of Copacabana\" , a main touristic attraction, where you ha', 'neighborhood_overview': '', 'picture_url': 'https://a0.muscache.com/pictures/3582382/ee8acc55_original.jpg', 'host_id': 1207700, 'host_url': 'https://www.airbnb.com/users/show/1207700', 'host_name': 'Maria Luiza', 'host_since': '2011-09-25', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Meu nome é Maria Luiza, adoro ajudar meus hóspedes, pois vivi muito tempo no exterior, falo várias línguas, e entendo como é viver fora da sua cidade.\\n\\n \\nFalo e escrevo em Inglês, francês, espanhol e português.', 'host_response_time': 'within a few hours', 'host_response_rate': '100%', 'host_acceptance_rate': '82%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/1207700/profile_pic/1316987019/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/1207700/profile_pic/1316987019/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 4.0, 'host_total_listings_count': 8.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': '', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.98238, 'longitude': -43.19215, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"Hangers\", \"Body soap\", \"Elevator\", \"Bed linens\", \"Microwave\", \"Wifi\", \"Dishes and silverware\", \"Hair dryer\", \"TV\", \"Iron\", \"Dining table\", \"Ceiling ... (61 characters truncated) ... eachfront\", \"Refrigerator\", \"Coffee maker: drip coffee maker\", \"Gas stove\", \"Hot water\", \"Extra pillows and blankets\", \"Kitchen\", \"Air conditioning\"]', 'price': '$180.00', 'minimum_nights': 3, 'maximum_nights': 89, 'minimum_minimum_nights': 3, 'maximum_minimum_nights': 3, 'minimum_maximum_nights': 89, 'maximum_maximum_nights': 89, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 89.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 0, 'availability_60': 0, 'availability_90': 0, 'availability_365': 204, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 78, 'number_of_reviews_ltm': 9, 'number_of_reviews_l30d': 1, 'first_review': '2011-11-17', 'last_review': '2023-09-11', 'review_scores_rating': 4.73, 'review_scores_accuracy': 4.83, 'review_scores_cleanliness': 4.86, 'review_scores_checkin': 4.89, 'review_scores_communication': 4.92, 'review_scores_location': 4.9, 'review_scores_value': 4.65, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 4, 'calculated_host_listings_count_entire_homes': 4, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.54}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(231516) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 231516, 'listing_url': 'https://www.airbnb.com/rooms/231516', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.71 · 1 bedroom · 1 bed', 'description': 'Special location of the building, on Copacabana beach, although the apartment does not have an ocean view, but it´s great for people who love the sea ... (702 characters truncated) ...  Ipanema. You are very close to the \"Fortress of Copacabana\", a main tourist attraction, where you have the most fantastic view of the famous Copacab', 'neighborhood_overview': '', 'picture_url': 'https://a0.muscache.com/pictures/3671683/d74b44a4_original.jpg', 'host_id': 1207700, 'host_url': 'https://www.airbnb.com/users/show/1207700', 'host_name': 'Maria Luiza', 'host_since': '2011-09-25', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Meu nome é Maria Luiza, adoro ajudar meus hóspedes, pois vivi muito tempo no exterior, falo várias línguas, e entendo como é viver fora da sua cidade.\\n\\n \\nFalo e escrevo em Inglês, francês, espanhol e português.', 'host_response_time': 'within a few hours', 'host_response_rate': '100%', 'host_acceptance_rate': '82%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/1207700/profile_pic/1316987019/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/1207700/profile_pic/1316987019/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 4.0, 'host_total_listings_count': 8.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': '', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.97787, 'longitude': -43.18792, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"TV\", \"Kitchen\", \"Wifi\", \"Elevator\", \"Air conditioning\"]', 'price': '$350.00', 'minimum_nights': 3, 'maximum_nights': 89, 'minimum_minimum_nights': 3, 'maximum_minimum_nights': 3, 'minimum_maximum_nights': 89, 'maximum_maximum_nights': 89, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 89.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 0, 'availability_60': 0, 'availability_90': 1, 'availability_365': 113, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 29, 'number_of_reviews_ltm': 0, 'number_of_reviews_l30d': 0, 'first_review': '2011-11-02', 'last_review': '2016-08-21', 'review_scores_rating': 4.71, 'review_scores_accuracy': 4.76, 'review_scores_cleanliness': 4.52, 'review_scores_checkin': 4.79, 'review_scores_communication': 4.86, 'review_scores_location': 4.93, 'review_scores_value': 4.38, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 4, 'calculated_host_listings_count_entire_homes': 4, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.2}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(236991) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 236991, 'listing_url': 'https://www.airbnb.com/rooms/236991', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.89 · 1 bedroom · 4 beds · 1 bath', 'description': 'Aconchegante, amplo, básico, arejado, iluminado com luz natural em prédio seguro e familiar. Prédio com portaria 24 horas e cameras de segurança em t ... (702 characters truncated) ...  BOX  DE CASAL ORTOBOM MASTER POCKET DE MOLAS ENSACADAS  E 2 CAMAS DE SOLTEIRO UMA DELAS ORTOBOM E BICAMA. O APTO TAMBÉM TEM AR CONDICIONADO E VENTIL', 'neighborhood_overview': 'Copacabana, apelidada a princesinha do mar, faz juz ao apelido.<br />Além de possuir uma das praias mais famosas e charmosas do Rio de Janeiro fornec ... (29 characters truncated) ... com variedade de restaurantes, agências de turismos, casas de câmbio, supermercados, drogarias, e a poucos passos um grande shopping (Rio Sul) e etc.', 'picture_url': 'https://a0.muscache.com/pictures/5725a59b-147d-4bf2-99f2-ba67f55ee770.jpg', 'host_id': 1241662, 'host_url': 'https://www.airbnb.com/users/show/1241662', 'host_name': 'Nilda', 'host_since': '2011-10-03', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Hellow ! Im Nilda!  I love Rio de Janeiro.    I work renting apartments for short time.  the  places  are simples!  but  very clean , safe and well p ... (229 characters truncated) ... tions services to the main and classic  touristic points more visited by the travellers in Rio de Janeiro.\\n\\nWelcome to Rio, welcome to Brazil! \\n\\n', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '96%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/fea78163-5495-401a-a620-ed948f59ac91.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/fea78163-5495-401a-a620-ed948f59ac91.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 2.0, 'host_total_listings_count': 2.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96488, 'longitude': -43.17478, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 5, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 4.0, 'amenities': '[\"Clothing storage: wardrobe\", \"Public or shared beach access\", \"Hangers\", \"Esmaltec gas stove\", \"Elevator\", \"Cooking basics\", \"32\\\\\" HDTV\", \"Room-da ... (278 characters truncated) ...  kettle\", \"Refrigerator\", \"Host greets you\", \"EV charger\", \"Mountain view\", \"Hot water\", \"Oven\", \"Kitchen\", \"Window AC unit\", \"Wifi \\\\u2013 14 Mbps\"]', 'price': '$190.00', 'minimum_nights': 5, 'maximum_nights': 14, 'minimum_minimum_nights': 4, 'maximum_minimum_nights': 7, 'minimum_maximum_nights': 1125, 'maximum_maximum_nights': 1125, 'minimum_nights_avg_ntm': 5.0, 'maximum_nights_avg_ntm': 1125.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 14, 'availability_60': 21, 'availability_90': 51, 'availability_365': 51, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 76, 'number_of_reviews_ltm': 24, 'number_of_reviews_l30d': 2, 'first_review': '2014-03-03', 'last_review': '2023-09-05', 'review_scores_rating': 4.89, 'review_scores_accuracy': 4.96, 'review_scores_cleanliness': 4.91, 'review_scores_checkin': 4.97, 'review_scores_communication': 4.96, 'review_scores_location': 4.99, 'review_scores_value': 4.89, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 2, 'calculated_host_listings_count_entire_homes': 2, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.65}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(17878) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 17878, 'listing_url': 'https://www.airbnb.com/rooms/17878', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Condo in Rio de Janeiro · ★4.70 · 2 bedrooms · 2 beds · 1 bath', 'description': 'Please note that elevated rates applies for New Years and Carnival. Price depends on length of stay and number of people. Generally I prefer a stay f ... (702 characters truncated) ... ss in Rio (apts with sea view are noisy because of traffic)<br />- \"Split\" air condition in each room (almost silent like in a hotel)<br />-  Smart T', 'neighborhood_overview': 'This is the one of the bests spots in Rio. Because of the large balcony and proximity to the beach, it has huge advantages in the current situation.', 'picture_url': 'https://a0.muscache.com/pictures/65320518/30698f38_original.jpg', 'host_id': 68997, 'host_url': 'https://www.airbnb.com/users/show/68997', 'host_name': 'Matthias', 'host_since': '2010-01-08', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'I  am a  journalist/writer. Lived  in NYC for 15 years. I  am now based in Rio and published 3 volumes of travel stories on AMAZ0N: \"The World Is My  ... (23 characters truncated) ... ver been to Rio, check out the first story, and you\\'ll get an idea. Apart from Rio, you\\'ll find  29 other travel stories from all around the globe.', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '96%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/67b13cea-8c11-49c0-a08d-7f42c330676e.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/67b13cea-8c11-49c0-a08d-7f42c330676e.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 2.0, 'host_total_listings_count': 5.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96599, 'longitude': -43.1794, 'property_type': 'Entire condo', 'room_type': 'Entire home/apt', 'accommodates': 5, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 2.0, 'beds': 2.0, 'amenities': '[\"Patio or balcony\", \"Hangers\", \"Paid parking off premises\", \"Elevator\", \"Cooking basics\", \"Private entrance\", \"Bed linens\", \"Microwave\", \"Wifi\", \"Di ... (119 characters truncated) ... \"Refrigerator\", \"Stove\", \"Smoking allowed\", \"Bathtub\", \"Hot water\", \"Oven\", \"Air conditioning\", \"Kitchen\", \"Luggage dropoff allowed\", \"Coffee maker\"]', 'price': '$279.00', 'minimum_nights': 5, 'maximum_nights': 28, 'minimum_minimum_nights': 5, 'maximum_minimum_nights': 5, 'minimum_maximum_nights': 28, 'maximum_maximum_nights': 28, 'minimum_nights_avg_ntm': 5.0, 'maximum_nights_avg_ntm': 28.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 14, 'availability_60': 21, 'availability_90': 38, 'availability_365': 265, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 301, 'number_of_reviews_ltm': 25, 'number_of_reviews_l30d': 1, 'first_review': '2010-07-15', 'last_review': '2023-09-11', 'review_scores_rating': 4.7, 'review_scores_accuracy': 4.77, 'review_scores_cleanliness': 4.64, 'review_scores_checkin': 4.83, 'review_scores_communication': 4.91, 'review_scores_location': 4.77, 'review_scores_value': 4.67, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 1.87}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(25026) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 25026, 'listing_url': 'https://www.airbnb.com/rooms/25026', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.71 · 1 bedroom · 1 bed · 1 bath', 'description': '**Fully renovated  in Dec 2022, new kitchen, new bathroom, new flooring! **<br />** O apto foi todo renovado, piso, banheiro e cozinha novos em Dez 2 ... (702 characters truncated) ...  walk there too, no need to hop on the subway really), very close to all local bars and restaurants, and very close to Ipanema and Lagoa (walking dis', 'neighborhood_overview': \"Copacabana is a lively neighborhood and the apartment is located very close to an area in Copa full of bars, cafes and restaurants at Rua Bolivar and Domingos Ferreira. Copacabana never sleeps, there is always movement and it's a great mix of all kinds of people.\", 'picture_url': 'https://a0.muscache.com/pictures/a745aa21-b8dd-4959-a040-eb8e6e6f07ee.jpg', 'host_id': 102840, 'host_url': 'https://www.airbnb.com/users/show/102840', 'host_name': 'Viviane', 'host_since': '2010-04-03', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Hi guys,\\n\\nViviane is a commercial photographer, an avid world traveler,  (a former photographer for Airbnb) and an Airbnb superhost. And a free lan ... (83 characters truncated) ... We  work together in providing the best accommodation to people and we are\\nfirm believers of enjoying the moment as a prime attitude towards life!\\n', 'host_response_time': 'within a few hours', 'host_response_rate': '100%', 'host_acceptance_rate': '73%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/315ddc81-bea3-4bf0-8fc7-be197a6541ff.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/315ddc81-bea3-4bf0-8fc7-be197a6541ff.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 1.0, 'host_total_listings_count': 5.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.97735, 'longitude': -43.19105, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 3, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"Clothing storage: wardrobe\", \"Dedicated workspace\", \"Public or shared beach access\", \"Hangers\", \"Elevator\", \"Cooking basics\", \"Room-darkening shade ... (275 characters truncated) ... \", \"Hammock\", \"TV with standard cable\", \"Refrigerator\", \"Stove\", \"Host greets you\", \"Hot water\", \"Oven\", \"Kitchen\", \"Window AC unit\", \"Coffee maker\"]', 'price': '$330.00', 'minimum_nights': 2, 'maximum_nights': 60, 'minimum_minimum_nights': 2, 'maximum_minimum_nights': 2, 'minimum_maximum_nights': 60, 'maximum_maximum_nights': 60, 'minimum_nights_avg_ntm': 2.0, 'maximum_nights_avg_ntm': 60.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 6, 'availability_60': 11, 'availability_90': 41, 'availability_365': 203, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 272, 'number_of_reviews_ltm': 24, 'number_of_reviews_l30d': 1, 'first_review': '2010-06-07', 'last_review': '2023-09-07', 'review_scores_rating': 4.71, 'review_scores_accuracy': 4.69, 'review_scores_cleanliness': 4.78, 'review_scores_checkin': 4.81, 'review_scores_communication': 4.92, 'review_scores_location': 4.84, 'review_scores_value': 4.59, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 1.68}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(238802) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 238802, 'listing_url': 'https://www.airbnb.com/rooms/238802', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Rental unit in Rio · ★4.77 · 3 bedrooms · 4 beds · 2 baths', 'description': 'SPACIOUS, CLEAN AND BRIGHT 3 BEDROOM APARTMENT WITH 2 BATHROOMS LOCATED AT ONLY 200 METERS FROM THE FAMOUS COPACABANA BEACH!!<br /><br /><b>The space ... (702 characters truncated) ... utility bills (electricity and gas) are not included in the rent and will be pay separately.<br /><br /><b>Guest access</b><br />We will meet our gue', 'neighborhood_overview': 'What makes Copacabana authentic is mainly because of its beautiful beach and striking pavement pattern. Day in and day out thousands of Cariocas and tourists stroll and jog on the famous wavy mosaic pavement in black and white marble, designed by Roberto Burle Marx.', 'picture_url': 'https://a0.muscache.com/pictures/46b95cc9-d4d6-4a90-b444-5ddaf9ecca11.jpg', 'host_id': 235496, 'host_url': 'https://www.airbnb.com/users/show/235496', 'host_name': 'Paola E Isak', 'host_since': '2010-09-15', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Swedish-Colombian couple in love with Rio & Barcelona, always looking for stunning sunsets! \\n\\nWe will be available by phone during your stay to ens ... (159 characters truncated) ... mos sempre disponíveis por telefone durante sua estadia para atender a quaisquer dúvidas que possam ter e para garantir uma experiência inesquecível.', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '100%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/75f13205-20fa-4b70-bd73-71f4b995b58a.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/75f13205-20fa-4b70-bd73-71f4b995b58a.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 5.0, 'host_total_listings_count': 10.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio, Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96386, 'longitude': -43.17757, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 8, 'bathrooms': 0.0, 'bathrooms_text': '2 baths', 'bedrooms': 3.0, 'beds': 4.0, 'amenities': '[\"Freezer\", \"Hangers\", \"Body soap\", \"Beach access\", \"Carbon monoxide alarm\", \"Kitchen\", \"Elevator\", \"Cooking basics\", \"Room-darkening shades\", \"Heati ... (496 characters truncated) ... \", \"Clothing storage\", \"Refrigerator\", \"Host greets you\", \"Bathtub\", \"Gas stove\", \"Hot water\", \"Oven\", \"Portable fans\", \"Extra pillows and blankets\"]', 'price': '$642.00', 'minimum_nights': 2, 'maximum_nights': 180, 'minimum_minimum_nights': 2, 'maximum_minimum_nights': 7, 'minimum_maximum_nights': 1125, 'maximum_maximum_nights': 1125, 'minimum_nights_avg_ntm': 2.3, 'maximum_nights_avg_ntm': 1125.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 25, 'availability_60': 34, 'availability_90': 51, 'availability_365': 289, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 97, 'number_of_reviews_ltm': 33, 'number_of_reviews_l30d': 2, 'first_review': '2011-11-17', 'last_review': '2023-09-17', 'review_scores_rating': 4.77, 'review_scores_accuracy': 4.86, 'review_scores_cleanliness': 4.87, 'review_scores_checkin': 4.9, 'review_scores_communication': 4.93, 'review_scores_location': 4.81, 'review_scores_value': 4.64, 'license': 0.0, 'instant_bookable': True, 'calculated_host_listings_count': 4, 'calculated_host_listings_count_entire_homes': 4, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.67}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(239531) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 239531, 'listing_url': 'https://www.airbnb.com/rooms/239531', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.58 · 1 bedroom · 2 beds · 1 bath', 'description': \"Varanda with a seaside view from the eleventh floor.  Bedroom with a double bed,  air, internet/WIFI, good bathroom, living with a sofabed, ceiling f ... (702 characters truncated) ... igh speed internet with wireless  connection (10 MB). A comfortable bathroom with automatic gas heater and hygienic shower.<br />The kitchen is all e\", 'neighborhood_overview': '', 'picture_url': 'https://a0.muscache.com/pictures/12451384/18c18103_original.jpg', 'host_id': 792218, 'host_url': 'https://www.airbnb.com/users/show/792218', 'host_name': 'Levy', 'host_since': '2011-07-07', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': \"I live with my wife in Copacabana, Rio, where I was born.  I'm a Rio's lover and like to host people from all over the world  in our apartments in Co ... (154 characters truncated) ... e receber pessoas de todas as partes do mundo nos nossos apartamentos em Copacabana e Ipanema, dando todas as necessárias dicas para uma boa estadia.\", 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '97%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/792218/profile_pic/1310233853/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/792218/profile_pic/1310233853/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 10.0, 'host_total_listings_count': 15.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': '', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96434, 'longitude': -43.17563, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 2.0, 'amenities': '[\"Patio or balcony\", \"Hangers\", \"Paid parking off premises\", \"Elevator\", \"Cooking basics\", \"Room-darkening shades\", \"Bed linens\", \"Pocket wifi\", \"Mic ... (302 characters truncated) ... V with standard cable\", \"Refrigerator\", \"Stove\", \"Host greets you\", \"Hot water\", \"Extra pillows and blankets\", \"Oven\", \"Kitchen\", \"Air conditioning\"]', 'price': '$200.00', 'minimum_nights': 2, 'maximum_nights': 150, 'minimum_minimum_nights': 2, 'maximum_minimum_nights': 2, 'minimum_maximum_nights': 150, 'maximum_maximum_nights': 150, 'minimum_nights_avg_ntm': 2.0, 'maximum_nights_avg_ntm': 150.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 5, 'availability_60': 13, 'availability_90': 43, 'availability_365': 318, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 109, 'number_of_reviews_ltm': 12, 'number_of_reviews_l30d': 2, 'first_review': '2011-12-08', 'last_review': '2023-09-21', 'review_scores_rating': 4.58, 'review_scores_accuracy': 4.66, 'review_scores_cleanliness': 4.33, 'review_scores_checkin': 4.79, 'review_scores_communication': 4.81, 'review_scores_location': 4.7, 'review_scores_value': 4.42, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 10, 'calculated_host_listings_count_entire_homes': 10, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.76}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(35764) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 35764, 'listing_url': 'https://www.airbnb.com/rooms/35764', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Loft in Rio de Janeiro · ★4.90 · 1 bedroom · 1 bed · 1.5 baths', 'description': 'Our newly renovated studio is located in the best part of Copacabana - Between  Posto 5 and Posto 6 - 10 minutes from the Arpoador and Ipanema beach. ... (702 characters truncated) ... golden 5 stars in all aspects. We care about your well being.!<br />Packages for Carnival 2020 is available.  Send a message to us.<br />Check in and', 'neighborhood_overview': 'Our guests will experience living with a local peole \"Carioca\"  in a very friendly building with 24 hours a day security with all kind of stores, banks, transports, restaurants.', 'picture_url': 'https://a0.muscache.com/pictures/23782972/1d3e55b0_original.jpg', 'host_id': 153691, 'host_url': 'https://www.airbnb.com/users/show/153691', 'host_name': 'Patricia Miranda & Paulo', 'host_since': '2010-06-27', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Hello,   We are Patricia Miranda and Paulo.\\r\\nWe are a couple who love to meet new people, new cultures, we both are  very easy going persons, we  l ... (363 characters truncated) ... g advice and recommendation about our wonderful city.\\r\\n\\r\\nWe were guest in Buenos Aires, João Pessoa, PB, Brooklin NY, and Manhattan.\\r\\n\\r\\n\\r\\n!', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '96%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/153691/profile_pic/1277774787/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/153691/profile_pic/1277774787/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 1.0, 'host_total_listings_count': 2.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.98107, 'longitude': -43.19136, 'property_type': 'Entire loft', 'room_type': 'Entire home/apt', 'accommodates': 2, 'bathrooms': 0.0, 'bathrooms_text': '1.5 baths', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"32\\\\\" HDTV with standard cable\", \"Hangers\", \"Carbon monoxide alarm\", \"Paid parking off premises\", \"Elevator\", \"Cooking basics\", \"Room-darkening sha ... (238 characters truncated) ... each view\", \"Essentials\", \"Refrigerator\", \"Stove\", \"Hot water\", \"Kitchen\", \"Window AC unit\", \"Luggage dropoff allowed\", \"Extra pillows and blankets\"]', 'price': '$192.00', 'minimum_nights': 3, 'maximum_nights': 15, 'minimum_minimum_nights': 3, 'maximum_minimum_nights': 5, 'minimum_maximum_nights': 7, 'maximum_maximum_nights': 15, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 14.8, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 4, 'availability_60': 8, 'availability_90': 11, 'availability_365': 46, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 446, 'number_of_reviews_ltm': 37, 'number_of_reviews_l30d': 1, 'first_review': '2010-10-03', 'last_review': '2023-09-11', 'review_scores_rating': 4.9, 'review_scores_accuracy': 4.93, 'review_scores_cleanliness': 4.93, 'review_scores_checkin': 4.97, 'review_scores_communication': 4.95, 'review_scores_location': 4.94, 'review_scores_value': 4.89, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 2.82}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(245951) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 245951, 'listing_url': 'https://www.airbnb.com/rooms/245951', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.86 · 1 bedroom · 2 beds · 1 bath', 'description': 'Great space for those who need leisure as well as work. We have 250 megs of Wi-Fi internet and 30,000 Btus Split air conditioning. for the greater co ... (702 characters truncated) ... major sights of Rio de Janeiro. <br />In the region has the best bars and restaurants, it is also possible to find all types of trade as pharmacies, ', 'neighborhood_overview': '', 'picture_url': 'https://a0.muscache.com/pictures/41861094/4e098c3e_original.jpg', 'host_id': 1289982, 'host_url': 'https://www.airbnb.com/users/show/1289982', 'host_name': 'Carnaval Turismo', 'host_since': '2011-10-14', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Carnaval Turismo é uma agência de viagens que tem como produto principal o Carnaval e o receptivo  no Rio de Janeiro. A Cidade Maravilhosa e um produ ... (333 characters truncated) ...  \\nImportante: \\nMANTEMOS UM RIGOROSO PROTOCOLO SANITÁRIO DE HOSPEDAGEM  DURANTE A PANDEMIA DE COVID-19 !  TOTAL PROTEÇÃOPARA OS NOSSOS HOSPEDES ! \\n', 'host_response_time': 'within a few hours', 'host_response_rate': '100%', 'host_acceptance_rate': '83%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/23c803d9-09b5-4692-b4fb-bed9c73c769a.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/23c803d9-09b5-4692-b4fb-bed9c73c769a.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 1.0, 'host_total_listings_count': 1.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': '', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96704, 'longitude': -43.18201, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 2.0, 'amenities': '[\"Private entrance\", \"Shampoo\", \"Essentials\", \"Hair dryer\", \"Bed linens\", \"TV with standard cable\", \"Refrigerator\", \"Dishes and silverware\", \"Stove\", ... (9 characters truncated) ... maker\", \"Hangers\", \"Microwave\", \"Hot water\", \"Iron\", \"Kitchen\", \"Window AC unit\", \"Wifi\", \"Elevator\", \"Extra pillows and blankets\", \"Cooking basics\"]', 'price': '$300.00', 'minimum_nights': 3, 'maximum_nights': 760, 'minimum_minimum_nights': 2, 'maximum_minimum_nights': 4, 'minimum_maximum_nights': 760, 'maximum_maximum_nights': 760, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 760.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 30, 'availability_60': 56, 'availability_90': 86, 'availability_365': 342, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 14, 'number_of_reviews_ltm': 1, 'number_of_reviews_l30d': 0, 'first_review': '2012-03-05', 'last_review': '2023-06-11', 'review_scores_rating': 4.86, 'review_scores_accuracy': 5.0, 'review_scores_cleanliness': 5.0, 'review_scores_checkin': 4.86, 'review_scores_communication': 4.93, 'review_scores_location': 4.86, 'review_scores_value': 4.86, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.1}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(48305) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 48305, 'listing_url': 'https://www.airbnb.com/rooms/48305', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Ipanema · ★4.74 · 6 bedrooms · 7 beds · 7 baths', 'description': 'Enter Bossa Nova\\'s history by staying in the very street real-life ‘Girl From Ipanema\\' used to \"each day walk to the sea\".<br /><br />» Penthouse w ... (704 characters truncated) ... d that guests look for remote-work ready, locally rooted, and experience-driven properties with a dedicated team taking pride in going the extra mile', 'neighborhood_overview': 'Enter Bossa Nova history by staying in the very street where real-life \\'Girl From Ipanema\\' inspired Vinicius de Moraes to write the worldwide famou ... (281 characters truncated) ... r />Ipanema and Leblon are by far the safest locations in Rio, with popular restaurants, cafes and boutique stores walking distance to the apartment.', 'picture_url': 'https://a0.muscache.com/pictures/miso/Hosting-48305/original/cce14bf9-c5b6-44c6-a89f-61323975afdb.jpeg', 'host_id': 70933, 'host_url': 'https://www.airbnb.com/users/show/70933', 'host_name': 'Goitaca', 'host_since': '2010-01-16', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'A new frontier of hospitality\\n\\nThe word meaning ‘Nomad’ in the native language of Tupi Guarani, Goitaca symbolizes a new genre of travel, one built ... (1200 characters truncated) ...  unforgettable Rio story. Working together since 2011, we have been lucky to welcome over 2,000 guests and continue to connect and learn from them.  ', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '97%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/c2d77835-fab6-45f9-a3ef-ef570dda44a5.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/c2d77835-fab6-45f9-a3ef-ef570dda44a5.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Ipanema', 'host_listings_count': 11.0, 'host_total_listings_count': 32.0, 'host_verifications': \"['email', 'phone', 'work_email']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Ipanema, Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Ipanema', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.98591, 'longitude': -43.20302, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 13, 'bathrooms': 0.0, 'bathrooms_text': '7 baths', 'bedrooms': 6.0, 'beds': 7.0, 'amenities': '[\"BBQ grill\", \"Hangers\", \"Paid dryer \\\\u2013 In unit\", \"Carbon monoxide alarm\", \"Paid parking off premises\", \"Cooking basics\", \"Private entrance\", \"S ... (381 characters truncated) ... s\", \"Baby bath\", \"Refrigerator\", \"Stove\", \"Host greets you\", \"Hot water\", \"Oven\", \"Kitchen\", \"Luggage dropoff allowed\", \"Extra pillows and blankets\"]', 'price': '$3,448.00', 'minimum_nights': 2, 'maximum_nights': 89, 'minimum_minimum_nights': 2, 'maximum_minimum_nights': 5, 'minimum_maximum_nights': 89, 'maximum_maximum_nights': 89, 'minimum_nights_avg_ntm': 2.4, 'maximum_nights_avg_ntm': 89.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 13, 'availability_60': 27, 'availability_90': 48, 'availability_365': 306, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 152, 'number_of_reviews_ltm': 30, 'number_of_reviews_l30d': 4, 'first_review': '2011-03-02', 'last_review': '2023-09-10', 'review_scores_rating': 4.74, 'review_scores_accuracy': 4.69, 'review_scores_cleanliness': 4.69, 'review_scores_checkin': 4.82, 'review_scores_communication': 4.81, 'review_scores_location': 4.94, 'review_scores_value': 4.59, 'license': 0.0, 'instant_bookable': True, 'calculated_host_listings_count': 9, 'calculated_host_listings_count_entire_homes': 8, 'calculated_host_listings_count_private_rooms': 1, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.99}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(247052) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 247052, 'listing_url': 'https://www.airbnb.com/rooms/247052', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · 2 bedrooms · 2 beds · 3 baths', 'description': 'Exceptionally cozy apartment in a beautiful location. Spacious and comfortable with a homey feel. Full community gym, game room, sauna and Kids play  ... (559 characters truncated) ... artment complex with excellent presentation. <br /><br />Welcome!<br /><br /><b>Guest access</b><br />Full access to the apartment and its amenities!', 'neighborhood_overview': '- Front view of Christ the Redeemer <br />- Near the metro station<br />- Sugar Loaf is within walking distance <br />- Quiet street in Botafogo <br />- 10 minute bike ride to Copacabana and Leme, 20 minutes by bike to Arpoador, Ipanema and Lagoa.', 'picture_url': 'https://a0.muscache.com/pictures/10711212/bf31590d_original.jpg', 'host_id': 1295841, 'host_url': 'https://www.airbnb.com/users/show/1295841', 'host_name': 'Osmar', 'host_since': '2011-10-15', 'host_location': 'Brazil', 'host_about': 'Tenho 50 anos,  sou casado e tenho 3 filhos.\\r\\nSou empresário e já trabalhei em várias empresas e hoje faço o meu proprio negócio. \\r\\nSou educado e ... (193 characters truncated) ... - ES. \\r\\nMe interesso por pessoas diversas e novas culturas. O Rio de Janeiro é encantador e acolhedor. Posso dar as melhores dicas de boa diversão.', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/ff4fbc73-422b-44bc-8edb-1877e9d09766.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/ff4fbc73-422b-44bc-8edb-1877e9d09766.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Botafogo', 'host_listings_count': 1.0, 'host_total_listings_count': 1.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': False, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Botafogo', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.95665, 'longitude': -43.18481, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '3 baths', 'bedrooms': 2.0, 'beds': 2.0, 'amenities': '[\"Free parking on premises\", \"Washer\", \"TV\", \"Dryer\", \"Kitchen\", \"Gym\", \"Elevator\", \"Air conditioning\"]', 'price': '$736.00', 'minimum_nights': 5, 'maximum_nights': 730, 'minimum_minimum_nights': 5, 'maximum_minimum_nights': 5, 'minimum_maximum_nights': 730, 'maximum_maximum_nights': 730, 'minimum_nights_avg_ntm': 5.0, 'maximum_nights_avg_ntm': 730.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 0, 'availability_60': 0, 'availability_90': 0, 'availability_365': 3, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 0, 'number_of_reviews_ltm': 0, 'number_of_reviews_l30d': 0, 'first_review': '', 'last_review': '', 'review_scores_rating': 0.0, 'review_scores_accuracy': 0.0, 'review_scores_cleanliness': 0.0, 'review_scores_checkin': 0.0, 'review_scores_communication': 0.0, 'review_scores_location': 0.0, 'review_scores_value': 0.0, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.0}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(48901) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 48901, 'listing_url': 'https://www.airbnb.com/rooms/48901', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio · ★4.37 · 4 bedrooms · 5 beds · 3 baths', 'description': 'Excelente   4 quartos, com conforto e facilidades.  Praia de Copacabana posto 2.<br />A localização na praia atende a aqueles que vem desfutrar do la ... (702 characters truncated) ... works.<br /><br /><b>Other things to note</b><br />5 kilowats dialy included. Extras can be charged at departure. <br />Groups of young males please ', 'neighborhood_overview': 'Plenty of shops, entertainment andrestaurants<br />Easy to get around. <br />Beach breezy.', 'picture_url': 'https://a0.muscache.com/pictures/95d13a3a-e5a6-4d48-b286-e929387fe945.jpg', 'host_id': 222884, 'host_url': 'https://www.airbnb.com/users/show/222884', 'host_name': 'Marcio', 'host_since': '2010-09-03', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'Carioca \" da gema \", fala português e inglês. Administração com respeito e paixão.\\nTrue Local  ( Born in Rio 1969 ) . Passion for Administration and respect.\\nVerdadeiro Carioca de Rio , Administra con respecto y sensibilidad.', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '92%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/222884/profile_pic/1283553621/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/222884/profile_pic/1283553621/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 1.0, 'host_total_listings_count': 6.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio, Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.96574, 'longitude': -43.17514, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 9, 'bathrooms': 0.0, 'bathrooms_text': '3 baths', 'bedrooms': 4.0, 'beds': 5.0, 'amenities': '[\"Clothing storage: wardrobe\", \"Hangers\", \"Mini fridge\", \"Pets allowed\", \"Elevator\", \"Cooking basics\", \"Bed linens\", \"Paid parking garage on premises ... (274 characters truncated) ... sentials\", \"TV with standard cable\", \"Refrigerator\", \"Stove\", \"Host greets you\", \"Smoking allowed\", \"Hot water\", \"Oven\", \"Kitchen\", \"Window AC unit\"]', 'price': '$703.00', 'minimum_nights': 3, 'maximum_nights': 750, 'minimum_minimum_nights': 3, 'maximum_minimum_nights': 3, 'minimum_maximum_nights': 750, 'maximum_maximum_nights': 750, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 750.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 16, 'availability_60': 24, 'availability_90': 54, 'availability_365': 307, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 20, 'number_of_reviews_ltm': 12, 'number_of_reviews_l30d': 2, 'first_review': '2015-08-01', 'last_review': '2023-09-10', 'review_scores_rating': 4.37, 'review_scores_accuracy': 4.58, 'review_scores_cleanliness': 3.95, 'review_scores_checkin': 4.89, 'review_scores_communication': 4.84, 'review_scores_location': 4.89, 'review_scores_value': 4.32, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 0.2}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(247779) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 247779, 'listing_url': 'https://www.airbnb.com/rooms/247779', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.75 · 1 bedroom · 1 bed · 1 bath', 'description': 'It´s t. Very cozy, confortable, sunny ( morning sun ) and clean apartment, nearby supermarket, stores , bars, subway station and near by General Ozór ... (702 characters truncated) ... stores , bars, subway station and near by General Ozório park where there is a free market every sunday. <br /><br />Located at posto 8 in Ipanema ne', 'neighborhood_overview': 'There is bar ,restaurantes, supermarket, drogstore and the apartment is 2 minutes from the beach', 'picture_url': 'https://a0.muscache.com/pictures/5983438/5e6a7829_original.jpg', 'host_id': 1298591, 'host_url': 'https://www.airbnb.com/users/show/1298591', 'host_name': 'Karina', 'host_since': '2011-10-16', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': 'I am an actress  . I love to work, travel and be with friends .', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '70%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/1298591/profile_pic/1421192290/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/1298591/profile_pic/1421192290/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 2.0, 'host_total_listings_count': 4.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.9851, 'longitude': -43.1932, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 3, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"Hangers\", \"Beach access\", \"Paid parking off premises\", \"Free street parking\", \"Elevator\", \"Cooking basics\", \"Washer\", \"Wifi\", \"Dishes and silverwar ... (70 characters truncated) ... ssentials\", \"TV with standard cable\", \"Refrigerator\", \"Stove\", \"Host greets you\", \"Hot water\", \"Oven\", \"Air conditioning\", \"Kitchen\", \"Coffee maker\"]', 'price': '$170.00', 'minimum_nights': 2, 'maximum_nights': 180, 'minimum_minimum_nights': 1, 'maximum_minimum_nights': 2, 'minimum_maximum_nights': 180, 'maximum_maximum_nights': 180, 'minimum_nights_avg_ntm': 2.0, 'maximum_nights_avg_ntm': 180.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 2, 'availability_60': 13, 'availability_90': 35, 'availability_365': 57, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 147, 'number_of_reviews_ltm': 7, 'number_of_reviews_l30d': 1, 'first_review': '2011-12-31', 'last_review': '2023-09-18', 'review_scores_rating': 4.75, 'review_scores_accuracy': 4.79, 'review_scores_cleanliness': 4.7, 'review_scores_checkin': 4.91, 'review_scores_communication': 4.96, 'review_scores_location': 4.93, 'review_scores_value': 4.62, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 2, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 1, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 1.03}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(49179) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 49179, 'listing_url': 'https://www.airbnb.com/rooms/49179', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-22', 'source': 'city scrape', 'name': 'Rental unit in Rio de Janeiro · ★4.81 · 1 bedroom · 1 bed · 1 bath', 'description': 'Beautiful 12th Floor Ocean View Studio steps from Copacabana Beach.  Comfortable queen sized bed, HDTV with Cable channels & Netflix. High Speed Inte ... (702 characters truncated) ... e and 24 hour doorman.<br /><br />- Towels and linens are included in the stay.<br /><br />- High Speed Wireless internet free for use.<br /><br />- ', 'neighborhood_overview': '', 'picture_url': 'https://a0.muscache.com/pictures/9a4f46f5-cfeb-42ae-bc3b-8c7d65817821.jpg', 'host_id': 224192, 'host_url': 'https://www.airbnb.com/users/show/224192', 'host_name': 'David', 'host_since': '2010-09-05', 'host_location': 'Mesa, AZ', 'host_about': 'I love spending time with my family, watching films, and exploring new places.\\r\\n\\r\\n', 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '97%', 'host_is_superhost': True, 'host_thumbnail_url': 'https://a0.muscache.com/im/pictures/user/8ad2769e-719e-4aa9-a395-ada7d27d3310.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/pictures/user/8ad2769e-719e-4aa9-a395-ada7d27d3310.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 21.0, 'host_total_listings_count': 23.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': '', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.9791, 'longitude': -43.19008, 'property_type': 'Entire rental unit', 'room_type': 'Entire home/apt', 'accommodates': 3, 'bathrooms': 0.0, 'bathrooms_text': '1 bath', 'bedrooms': 1.0, 'beds': 1.0, 'amenities': '[\"Clothing storage: wardrobe\", \"Dedicated workspace\", \"Public or shared beach access\", \"Hangers\", \"Mini fridge\", \"Elevator\", \"Cooking basics\", \"Room- ... (377 characters truncated) ... iew\", \"Ceiling fan\", \"Essentials\", \"Refrigerator\", \"Hot water\", \"Kitchen\", \"Window AC unit\", \"Luggage dropoff allowed\", \"Extra pillows and blankets\"]', 'price': '$201.00', 'minimum_nights': 4, 'maximum_nights': 90, 'minimum_minimum_nights': 4, 'maximum_minimum_nights': 5, 'minimum_maximum_nights': 1125, 'maximum_maximum_nights': 1125, 'minimum_nights_avg_ntm': 4.0, 'maximum_nights_avg_ntm': 1125.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 5, 'availability_60': 10, 'availability_90': 22, 'availability_365': 159, 'calendar_last_scraped': '2023-09-22', 'number_of_reviews': 147, 'number_of_reviews_ltm': 20, 'number_of_reviews_l30d': 1, 'first_review': '2012-11-24', 'last_review': '2023-09-05', 'review_scores_rating': 4.81, 'review_scores_accuracy': 4.86, 'review_scores_cleanliness': 4.65, 'review_scores_checkin': 4.89, 'review_scores_communication': 4.93, 'review_scores_location': 4.88, 'review_scores_value': 4.7, 'license': 0.0, 'instant_bookable': True, 'calculated_host_listings_count': 20, 'calculated_host_listings_count_entire_homes': 20, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 1.12}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n",
      "(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"listings_pkey\"\n",
      "DETAIL:  Key (id)=(248756) already exists.\n",
      "\n",
      "[SQL: INSERT INTO trusted.listings (id, listing_url, scrape_id, last_scraped, source, name, description, neighborhood_overview, picture_url, host_id, host_url, host_name, host_since, host_location, host_about, host_response_time, host_response_rate, host_acceptance_rate, host_is_superhost, host_thumbnail_url, host_picture_url, host_neighbourhood, host_listings_count, host_total_listings_count, host_verifications, host_has_profile_pic, host_identity_verified, neighbourhood, neighbourhood_cleansed, neighbourhood_group_cleansed, latitude, longitude, property_type, room_type, accommodates, bathrooms, bathrooms_text, bedrooms, beds, amenities, price, minimum_nights, maximum_nights, minimum_minimum_nights, maximum_minimum_nights, minimum_maximum_nights, maximum_maximum_nights, minimum_nights_avg_ntm, maximum_nights_avg_ntm, calendar_updated, has_availability, availability_30, availability_60, availability_90, availability_365, calendar_last_scraped, number_of_reviews, number_of_reviews_ltm, number_of_reviews_l30d, first_review, last_review, review_scores_rating, review_scores_accuracy, review_scores_cleanliness, review_scores_checkin, review_scores_communication, review_scores_location, review_scores_value, license, instant_bookable, calculated_host_listings_count, calculated_host_listings_count_entire_homes, calculated_host_listings_count_private_rooms, calculated_host_listings_count_shared_rooms, reviews_per_month) VALUES (%(id)s, %(listing_url)s, %(scrape_id)s, %(last_scraped)s, %(source)s, %(name)s, %(description)s, %(neighborhood_overview)s, %(picture_url)s, %(host_id)s, %(host_url)s, %(host_name)s, %(host_since)s, %(host_location)s, %(host_about)s, %(host_response_time)s, %(host_response_rate)s, %(host_acceptance_rate)s, %(host_is_superhost)s, %(host_thumbnail_url)s, %(host_picture_url)s, %(host_neighbourhood)s, %(host_listings_count)s, %(host_total_listings_count)s, %(host_verifications)s, %(host_has_profile_pic)s, %(host_identity_verified)s, %(neighbourhood)s, %(neighbourhood_cleansed)s, %(neighbourhood_group_cleansed)s, %(latitude)s, %(longitude)s, %(property_type)s, %(room_type)s, %(accommodates)s, %(bathrooms)s, %(bathrooms_text)s, %(bedrooms)s, %(beds)s, %(amenities)s, %(price)s, %(minimum_nights)s, %(maximum_nights)s, %(minimum_minimum_nights)s, %(maximum_minimum_nights)s, %(minimum_maximum_nights)s, %(maximum_maximum_nights)s, %(minimum_nights_avg_ntm)s, %(maximum_nights_avg_ntm)s, %(calendar_updated)s, %(has_availability)s, %(availability_30)s, %(availability_60)s, %(availability_90)s, %(availability_365)s, %(calendar_last_scraped)s, %(number_of_reviews)s, %(number_of_reviews_ltm)s, %(number_of_reviews_l30d)s, %(first_review)s, %(last_review)s, %(review_scores_rating)s, %(review_scores_accuracy)s, %(review_scores_cleanliness)s, %(review_scores_checkin)s, %(review_scores_communication)s, %(review_scores_location)s, %(review_scores_value)s, %(license)s, %(instant_bookable)s, %(calculated_host_listings_count)s, %(calculated_host_listings_count_entire_homes)s, %(calculated_host_listings_count_private_rooms)s, %(calculated_host_listings_count_shared_rooms)s, %(reviews_per_month)s)]\n",
      "[parameters: {'id': 248756, 'listing_url': 'https://www.airbnb.com/rooms/248756', 'scrape_id': 20230922043705, 'last_scraped': '2023-09-23', 'source': 'city scrape', 'name': 'Condo in Rio de Janeiro · ★4.76 · 2 bedrooms · 2 beds · 1.5 baths', 'description': \"Two bedroom apartment, air conditioning, one block away from beach, two blocks away from subway, wifi internet, with one full bathroom and a second s ... (702 characters truncated) ... hem close to the rooms and the other one, very small, close to the kitchen. We also offer high speed wireless internet. Our building has an elevator \", 'neighborhood_overview': \"Copacabana is a busy neighbourhood with LOTS of restaurants, bars and shops. Aside from the bars, you'd probably have more fun spending the nights in ... (33 characters truncated) ... o some theaters (playhouses) here. My favorite thing in Copa is the beach. Also, it's great to be so close to Ipanema, Botafogo and Lapa all at once.\", 'picture_url': 'https://a0.muscache.com/pictures/2760278/678838e2_original.jpg', 'host_id': 804664, 'host_url': 'https://www.airbnb.com/users/show/804664', 'host_name': 'Bernardo', 'host_since': '2011-07-11', 'host_location': 'Rio de Janeiro, Brazil', 'host_about': \"Eu adoro ler, ir ao cinema, tocar violão.  Morro de vontade de conhecer o Rio Grande do Sul.  Quero ir mais vezes ao Uruguay, e quero conhecer Peru e ... (164 characters truncated) ... ande do Sul.  I want to go more times to Uruguay, and I want go to Peru and Bolivia.  I never traveled using Airbnb, but I can hardly wait to try it!\", 'host_response_time': 'within an hour', 'host_response_rate': '100%', 'host_acceptance_rate': '87%', 'host_is_superhost': False, 'host_thumbnail_url': 'https://a0.muscache.com/im/users/804664/profile_pic/1318901822/original.jpg?aki_policy=profile_small', 'host_picture_url': 'https://a0.muscache.com/im/users/804664/profile_pic/1318901822/original.jpg?aki_policy=profile_x_medium', 'host_neighbourhood': 'Copacabana', 'host_listings_count': 1.0, 'host_total_listings_count': 2.0, 'host_verifications': \"['email', 'phone']\", 'host_has_profile_pic': True, 'host_identity_verified': True, 'neighbourhood': 'Rio de Janeiro, Brazil', 'neighbourhood_cleansed': 'Copacabana', 'neighbourhood_group_cleansed': 0.0, 'latitude': -22.98029, 'longitude': -43.19054, 'property_type': 'Entire condo', 'room_type': 'Entire home/apt', 'accommodates': 4, 'bathrooms': 0.0, 'bathrooms_text': '1.5 baths', 'bedrooms': 2.0, 'beds': 2.0, 'amenities': '[\"AC - split type ductless system\", \"Room-darkening shades\", \"Essentials\", \"Wifi\", \"Hair dryer\", \"Refrigerator\", \"Dishwasher\", \"Stove\", \"Host greets  ... (17 characters truncated) ... ss\", \"Washer\", \"Hot water\", \"Microwave\", \"Iron\", \"Oven\", \"Kitchen\", \"42\\\\\" HDTV with Netflix\", \"Elevator\", \"Dishes and silverware\", \"Cooking basics\"]', 'price': '$358.00', 'minimum_nights': 3, 'maximum_nights': 90, 'minimum_minimum_nights': 3, 'maximum_minimum_nights': 3, 'minimum_maximum_nights': 90, 'maximum_maximum_nights': 90, 'minimum_nights_avg_ntm': 3.0, 'maximum_nights_avg_ntm': 90.0, 'calendar_updated': 0.0, 'has_availability': True, 'availability_30': 13, 'availability_60': 29, 'availability_90': 49, 'availability_365': 49, 'calendar_last_scraped': '2023-09-23', 'number_of_reviews': 154, 'number_of_reviews_ltm': 18, 'number_of_reviews_l30d': 1, 'first_review': '2011-10-21', 'last_review': '2023-09-10', 'review_scores_rating': 4.76, 'review_scores_accuracy': 4.82, 'review_scores_cleanliness': 4.78, 'review_scores_checkin': 4.89, 'review_scores_communication': 4.9, 'review_scores_location': 4.71, 'review_scores_value': 4.66, 'license': 0.0, 'instant_bookable': False, 'calculated_host_listings_count': 1, 'calculated_host_listings_count_entire_homes': 1, 'calculated_host_listings_count_private_rooms': 0, 'calculated_host_listings_count_shared_rooms': 0, 'reviews_per_month': 1.06}]\n",
      "(Background on this error at: https://sqlalche.me/e/20/gkpj)\n"
     ]
    }
   ],
   "source": [
    "db_listing = DatabaseHandler()\n",
    "try:\n",
    "    db_listing.post_data(table=\"listings\", data=data_listining[0:15], schema=\"trusted\")\n",
    "except Exception as e:\n",
    "    print(e)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
